---
layout: post
title: OS
categories:
  - overall 
# feature_image: ""
tags: 컴퓨터과학, OS, 운영체제
---
> 운영체제, [한재엽님의 Part 1-4 OS](https://github.com/JaeYeopHan/Interview_Question_for_Beginner/tree/master/OS)를 기반으로 여러분들의 블로그를 참조!

# 운영체제
### 프로세스와 스레드의 차이
#### 프로세스(Process)
- 프로세스는 실행중인 프로그램
- 디스크에서 메모리에 적재되어 CPU의 할당을 받을 수 있음
- OS로부터 주소 공간, 파일, 메모리 등을 할당 받게 됨
- 구성요소
  - 프로세스 스택 : 함수의 매개변수 / 복귀 주소 / 로컬 변수
  - 데이터 섹션 : 전역 변수
  - 메모리 힙 : 프로세스 실행 중 동적으로 할당되는 메모리

##### 프로세스 제어 블록(Process Control Block, PCB)
- 특정 프로세스에 중요한 정보를 저장하고 있는 운영체제의 자료구조
- 운영체제는 프로세스의 관리를 위해 프로세스의 생성과 동시에 고유한 PCB 생성
- 프로세스는 CPU를 할당 받아작업을 처리하다가 프로세스의 전환이 발생할 경우 진행하던 작업을 저장하고 CPU의 반환이 필요
  - 작업의 진행 상황을 PCB에 저장
- PCB에 저장되는 정보
  - 프로세스 식별자(Process ID, PID) : 프로세스 식별번호
  - 프로세스 상태 : new, ready, running, waiting, terminated 등의 상태 저장
  - 프로그램 카운터 : 프로세스가 다음에 실행할 명령어의 주소
  - CPU 레지스터
  - CPU 스케쥴링 정보 : 프로세스의 우선순위, 스케줄 큐에 대한 포인터 등
  - 메모리 관리 정보 : 페이지 테이블 또는 세그먼트 테이블 등과 같은 정보 포함
  - 입출력 상태 정보 : 프로세스에 할당된 입출력 장치들과 열린 파일 목록
  - 어카운팅 정보 : 사용된 CPU 시간, 시간제한, 계정번호 등

#### 스레드(Thread)
- 프로세스의 실행 단위
- 한 프로세스 내에서 동작되는 여러 실행 흐름
  - 프로세스 내의 주소 공간이나 자원의 공유 가능
- 구성
  - 스레드 ID
  - 프로그램 카운터
  - 레지스터 집합
  - 스택
- 공유자원(다른 스레드와)
  - 코드
  - 데이터 섹션
  - 운영체제 자원(열린 파일, 신호 등)
- 멀티스레딩
  - 하나의 프로세스를 다수의 실행 단위로 구분하여 자원을 공유
  - 자원의 생성과 관리의 중복성을 최소화함으로써 수행 능력 향상

##### 스택이 스레드마다 존재하는 이유
- 스택은 [함수 호출 시 전달되는 인자, 되돌아갈 주소값, 함수 내 선언 변수]에 사용
- 따라서 스택을 독립적으로 사용하면 독립적인 함수의 사용 가능
- 스택은 즉 독립적인 실행 흐름을 위한 최소 조건

##### PC Register를 스레드마다 독립할당하는 이유
- 프로세서 레지스터는 명령이 어디까지 수행됐는지를 저장
- 스레드는 CPU를 할당 받았다가 스케줄러에 의해 우선순위를 빼앗길 수 있음
- 다 수행되지 못한 명령어에 대해서 위치를 표시할 필요 존재

<br/>

### 멀티스레드
#### 장점
- 프로세스를 이용하여 동시에 처리하던 일을 스레드로 구현할 경우 메모리 공간과 시스템 자원 소모를 줄일 수 있음
- 스레드간 통신은 **전역 변수의 공간**이나 **heap영역**을 이용하므로 별도의 자원을 사용하지 않음(프로세스간 통신에 비해 훨씬 간단)
- 스레드의 context switch는 프로세스 context switch와 다르게 **캐시 메모리**를 유지

#### 단점
- 동일한 자원에 접근하는 경우에 대한 처리 필요
  - 동기화 작업 필요
  - 작업 순서 컨트롤, 자원 접근 컨트롤 필요
  - 하지만 위 작업들에 의해 병목현상이 발생할 가능성 존재

#### 멀티스레드 vs 멀티프로세스
- 멀티스레드가 멀티프로세스보다 적은 메모리 공간 사용 / context swtich 빠름
- 오류에 의해 하나 스레드 종료가 전체 스레드에 영향을 끼칠 가능성 존재


<br/>

### 스케줄러
프로세스의 스케줄링을 위한 Queue 
- Job Queue : 현재 시스템 내의 모든 프로세스 집합
- Ready Queue : 현재 메모리 내에 있으며, CPU를 점유하여 실행을 대기하는 프로세스 집합
- Device Queue : Device I/O 작업을 대기하는 프로세스 집합

각 Queue를 프로세스들에 넣고 빼는 스케줄러

#### 장기스케줄러(Long-term scheduler or job scheduler)
- 한정된 메모리에 많은 프로세스가 한꺼번에 메모리에 올라올 경우, 대용량 메모리(일반적인 디스크)에 임시 저장
- 이 pool에 저장되어 있는 프로세스 중 어떤 프로세스에 메모리를 할당하여 Ready Queue로 보낼지 결정
- 메모리<->디스크 사이의 스케줄링 담당
- 프로세스에 memory를 할당
- Degree of Multiprogramming 제어(메모리에 몇 개의 프로그램이 올라갈지)
- 프로세스 상태 전환(new / running / watiting / ready / terminated )